<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>BDD Handschriften</title>
        <link rel="icon" type="image/png" href="../img/favicon.png" sizes="32x32">
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0 shrink-to-fit=no"/>
        <meta name="google" content="notranslate"/>
        
        <link href="../CSS/bootstrap.min.css" rel="stylesheet">
        <script src="../js/bootstrap.bundle.min.js"></script>
        
        
        
        <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
        
        <!-- // Leaflet-->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
        
        <!-- // Leaflet subgroup Plugin -->
        <script src="https://unpkg.com/leaflet.featuregroup.subgroup@1.0.2/dist/leaflet.featuregroup.subgroup.js"></script>
        
        <!-- // Leaflet cluster Plugin -->
        <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js" crossorigin=""></script>
        <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" crossorigin=""/>
        <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" crossorigin=""/>
         
        <!--Fontawesome-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
    
        <link rel="stylesheet" type="text/css" href="../CSS/style.css" media="screen"/>
        <script src="../js/bdd_manuscriptdb.js"></script>
        <script src="../js/language.js"></script>
        <script src="../js/navigation.js" defer></script>
    </head>


    <body>
        <div id="navbar-placeholder"></div>
        <div class="back-button ps-4" style="margin-top:40px;">
          <button class="btn btn-outline-secondary rounded-circle hBack" type="button"><i class="fas fa-arrow-left"></i></button>
        </div>
        <div class="container" style="flex:1">
            <h1 class="section-main-title">
              <span lang="de">HANDSCHRIFTEN</span><span lang="en">MANUSCRIPTS</span>
              <span style="vertical-align: super;"><button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#desktopModal" style="padding: 0;">
                <i class="fa-solid fa-circle-info fa-xl" style="color: #46b65f; "></i></button></span>
            </h1>


            <!-- Modal Info-->
          <div class="modal fade" id="desktopModal" tabindex="-1" aria-labelledby="desktopModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="desktopModalLabel" style="font-weight: bold;"><span lang="de">HANDSCHRIFTEN</span><span lang="en">MANUSCRIPTS</span></h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="infoHandschriften">
                  
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"><span lang="de">Schließen</span><span lang="en">Close</span></button>
                  
                </div>
              </div>
            </div>
          </div>

            
        
            <div class="mss-table table-responsive">
                <table id="mss-table-1" style="width:100%" class="table table-hover">
                    <!-- Table headers -->
                    <thead>
                      <tr>
                        <th scope="col" class="heading" onclick="sortTable(0)">Signatur</th>
                        <th scope="col" class="heading" onclick="sortTable(1)">Sigle</th>
                        <th scope="col" class="heading" onclick="sortTable(2)">Entstehungsort</th>
                        <th scope="col" class="heading" onclick="sortTable(3)">Entstehungszeit</th>
                      </tr>
                    </thead>
                    <!-- Filter inputs -->
                    <thead>
                      <tr>
                        <th class="mss-filter-table">
                          <input type="text" class="mss-filter" id="mss-filter-1" onkeyup="filterMss('1')" placeholder="Eingabe für Filter"/>
                        </th>
                        <th class="mss-filter-table">
                          <input type="text" class="mss-filter" id="mss-filter-2" onkeyup="filterMss('2')" placeholder="Eingabe für Filter"/>
                        </th>
                        <th class="mss-filter-table">
                          <input type="text" class="mss-filter" id="mss-filter-3" onkeyup="filterMss('3')" placeholder="Eingabe für Filter"/>
                        </th>
                        <th class="mss-filter-table">
                          <input type="text" class="mss-filter" id="mss-filter-4" onkeyup="filterMss('4')" placeholder="Eingabe für Filter"/>
                        </th>
                      </tr>
                    </thead>
                    <!-- Table body for data -->
                    <tbody id="table-body">
                      <!-- Table rows will be dynamically added here -->
                    </tbody>
                  </table>

            </div>
            
            <div class="mss-map-head">
                <h4 style="margin-top:40px; margin-bottom:40px" lang="de">KARTENANSICHT</h4>
                <h4 style="margin-top:40px; margin-bottom:40px" lang="en">MAP VIEW</h4>
            </div>
            <div class="mss-map" id="map2"></div>
            
        </div>

        <div id="footer-placeholder"></div>

    </body>


    <!--Embedding map--> 
    <script type="text/javascript">
      var mymap = L.map('map2').setView([48.00, 12], 5);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(mymap);
    </script>
    <script src="../js/map.js"></script>

    

    <!--data in ms-table-->
    <script>
        async function fetchDataAndPopulateTable() {
          try {
            const list_ms = ["B", "F", "K", "Va2", "Va3"]
            for (var ms in list_ms){
                const folderPath = '../data/mss/' + list_ms[ms] + '/Tei/v1'; // Update this with your XML folder path
                const response = await fetch(folderPath + '/msdesc.xml'); // Fetch the XML file
                if (response.ok) {
                    const xmlText = await response.text();
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(xmlText, 'text/xml');

                    const msNameFull = xmlDoc.querySelectorAll('msName[type="full"]')[0].innerHTML
                    const msNameSigle = xmlDoc.querySelectorAll('msName[type="sigle"]')[0].innerHTML
                    const origPlaceElement = xmlDoc.querySelector('origPlace');
                    const origPlaceText = Array.from(origPlaceElement.childNodes)
                        .filter(node => node.nodeName !== 'location' || node.nodeName === 'location' && node.childNodes.length === 0)
                        .map(node => node.textContent.trim())
                        .join(' ');

                    const origDate = xmlDoc.querySelectorAll('origDate')[0].innerHTML
            
                    const tableBody = document.getElementById('table-body');
                    const row = document.createElement('tr');
                    const cell1 = document.createElement('td');
                    const cell2 = document.createElement('td');
                    const cell3 = document.createElement('td');
                    const cell4 = document.createElement('td');
            
                    cell1.innerHTML = "<a href='ms-item.html?document="+ list_ms[ms] + "'>" + msNameFull + "</a>";
                    cell2.textContent = msNameSigle;
                    cell3.textContent = origPlaceText;
                    cell4.textContent = origDate;
            
                    row.appendChild(cell1);
                    row.appendChild(cell2);
                    row.appendChild(cell3);
                    row.appendChild(cell4);
            
                    tableBody.appendChild(row);
                } else {
                    console.error('Failed to fetch XML file.');
                }
            }
          } catch (error) {
            console.error('Error:', error);
          }
        }
    
        // Invoke the function when the page loads
        window.onload = fetchDataAndPopulateTable;
      </script>


<script>
  $(document).ready(function() {
      // Function to load HTML file
      function loadHTMLDoc(filename) {
            $.ajax({
                type: "GET",
                url: filename,
                dataType: "html",
                success: function(html) {
                    displayHTMLContent(html);
                },
                error: function(xhr, status, error) {
                    console.error("Error loading XML file:", error);
                }
            });
        }
  
      // Function to display HTML content
      function displayHTMLContent(htmlDoc) {
            let contentDiv = document.createElement('div');
            contentDiv.innerHTML = htmlDoc;
            let contentInfo = $(contentDiv).find("#infoHandschriften")
            $("#infoHandschriften").html(contentInfo);
                
            checkLanguage()
            }
  
      // Load XML file
      loadHTMLDoc("../data/texts/infoButtonsTexts.html"); // Adjust the path here
  });
  </script>
</html>